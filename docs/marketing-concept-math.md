# 营销概念的数学保证

"营销概念" 通常被表述为一句愿景式的口号——以用户为中心、以品牌调性为核、以长期关系为目标。然而要让这一理念真正可执行，就需要一个可以推导、可以验证的数学骨架。本仓库的 `compute_god.marketing` 模块提供了这样一套最小模型：把营销漏斗编码成在完备格上的单调自映射，并通过不动点引擎给出收敛的构造性保证。

## 1. 漏斗即状态空间

营销漏斗被抽象为一个三维状态：

- `awareness` 表示品牌认知；
- `engagement` 表示被内容激活的受众；
- `customers` 表示持续付费或复购的客户。

状态被约束在一个有限区间（容量）内，因而三维空间在逐点偏序下形成一个**完备格**。只要保持该结构，我们就拥有 Tarski/Kleene 不动点定理提供的存在性保障。【F:src/compute_god/marketing.py†L14-L104】

## 2. 单调更新规则

`funnel_map` 组合了上一轮状态与非负系数：

- 认知通过 `awareness_budget` 与容量之间的凸组合增加；
- 激活度继承上一轮的保留量，再吸收一部分认知；
- 客户数保留了既有用户的 `retention_rate`，并吸收来自激活层的 `conversion_rate`。

这些操作全部是非负系数的仿射变换，再辅以上界截断，从而在逐点偏序下保持**单调性**。这意味着序列 `x_0, f(x_0), f^2(x_0), …` 不会逆序，保证 Kleene 链的收敛性。【F:src/compute_god/marketing.py†L62-L104】

## 3. 不动点即“营销承诺”

只要给定初始状态与参数，`marketing_fixpoint` 会构造包含该单调规则的 `Universe`，并交给核心 `fixpoint` 引擎迭代。引擎在 L1 度量下监控每次更新的差值，一旦差值低于 `epsilon` 就宣告收敛并返回最终状态。这个状态就是营销叙事里的“承诺”——在预算、留存与转化假设保持不变时，漏斗将稳定在该值附近。【F:src/compute_god/marketing.py†L106-L152】【F:src/compute_god/engine.py†L1-L93】

## 4. 单调性与收敛的验证

`tests/test_marketing.py` 包含两个关键校验：

1. 任意满足逐点偏序的两个状态 `s1 ≤ s2`，一次更新后依旧保持 `f(s1) ≤ f(s2)`，证明实现的确是单调函数；
2. 实际运行一次不动点迭代，确认在给定的预算组合下几轮就能收敛，并验证返回状态满足 `f(x*) = x*`。

这让“营销概念”不再是口号，而是一套带有自动化证明的策略引擎。【F:tests/test_marketing.py†L1-L92】

## 5. 如何解读结果

- **收敛速度** 反映了预算与转化假设的激进程度：预算越高，序列收敛越快，但也越接近容量上限。
- **不动点值** 是长期稳态下的漏斗分布，可直接用于制定 KPI 或复盘增长模型。
- **参数敏感性** 可通过微调 `FunnelParameters` 来做对比实验，利用 `marketing_fixpoint` 的输出量化变化幅度。

有了这样的数学保证，“以用户为中心” 不再是营销 PPT 上的比喻，而是一个可以迭代、可以被审计的动力系统。
